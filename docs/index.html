<html><head><meta charset="UTF-8"/><meta name="description" content="Let your users import their data in your SAAS with a familiar excel like UI."/><meta name="author" content="Renan LE CARO"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Importabular : 5kb javascript spreadsheet component</title><link rel="icon" href="./logo.png"/><style type="text/css">body {
  font-family: Roboto, sans-serif;
  margin: 0;
  padding: 0;
}


section {
  color: white;
  background-attachment: fixed;
}
section a {
  color: white;
}
@media (max-width: 570px) {
  #editorNode {
    margin-left: -10px;
    margin-right: -10px;
    width: auto;
    align-self: stretch;
  }
}
@media (max-width: 1400px) {
  section {
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  section > * {
    width: 100%;
    max-width: 580px;
  }
  section > *:last-child {
    margin-top: 20px;
  }
  #editorNode > table {
    min-width: 100%;
  }
}
@media (min-width: 1400px) {
  section {
    padding: 80px;
    display: flex;
    min-height: 80vh;
    align-items: center;
    justify-content: center;
    font-size: 20px;
  }
  section > * {
    box-sizing: border-box;
    max-width: 600px;
    margin: 0 40px;
    flex-grow: 1;
    flex-shrink: 1;
  }
}

ul.checks {
  list-style: none;
  padding: 0;
}
ul.checks li {
  margin-bottom: 10px;
}
ul.checks li:before {
  content: "\2611";
  margin-right: 10px;
}
h1,
h2 {
  font-size: 44px;
  font-weight: 600;
}

#editorNode {
  overflow: auto;
}
pre > code {
  background: #2e3548;
  color: #e6f7fd;
  border-radius: 4px;
  display: block;
  font-size: 14px;
  padding: 20px;
  overflow: auto;
  max-width: 100%;
  max-height: 70vh;
}
pre.auto {
  display: block;
  white-space: pre;
  background: white;
  color: black;
  padding: 20px;
  font-family: monospace;
  line-height: 20px;
  margin-bottom: 40px;
  font-size: 12px;
  max-height: 80vh;
  overflow: auto;
}
section.sample {
  color: rgba(0, 0, 0, 0.8);
}

section.sample > :first-child {
  /*We flip the order of the script and the container so that the script can see the container when it runs*/
  order: 2;
}
.github-corner {
  display: block;
  text-decoration: none;
  background: white;
  color: black;
  text-align: center;
  padding: 20px;
}
@media screen and (min-width: 1200px) {
  .github-corner {
    position: fixed;
    top: 0;
    right: 0;
    padding: 10px 60px;
    transform: translate(50px,50px) rotate(45deg);
  }
}
</style></head><body><section class="sample" style="background-image: linear-gradient(-141deg, #cda9f9, #96c4ff)"><div id="editor"></div><div><h1>Minimal spreadsheet javascript component</h1><p>Install it from npm</p><pre><code>npm install importabular</code></pre><p>Instantiate it on a dom node</p><pre><code data-script="simple"></code></pre><p>Manipulate the sheet programmatically</p><pre><code lang="javascript">sheet.getData();</code></pre><pre><code lang="javascript">sheet.setData([['First','line','text']);</code></pre><pre><code lang="javascript">sheet.destroy()</code></pre></div></section><section class="sample" style="background-image: linear-gradient(141deg, #f25407, #ac02f9);"><div id="with-checks"></div><div><h2>More complete example</h2><pre><code data-script="with-checks"></code></pre></div></section><section style="background-image: linear-gradient(141deg, #0096c4, #165fac)"><div><h2>Goals and limitations</h2><p>I've created this lib because I was tired of having to remove 90% of the features offered by the very few open source libs for web spreadsheets.</p><p>So for this reinventing the wheel to make sense, I should not add any extra features to this core.</p><ul><li>No "drag cell corner to expand its value"</li><li>No virtual rendering</li><li>No sorting, pivot, formula, etc ..</li><li>Only basic keyboard shortcuts</li><li>Only strings as data type</li><li>Only for recent browsers</li></ul><p>The lib is fresh and not battle tested, probably has some bugs. The API is not stable yet. Feel free to <a href="https://github.com/renanlecaro/importabular/issues/new">create an issue</a> if you find a bug.</p></div></section><a href="https://github.com/renanlecaro/importabular" class="github-corner" aria-label="View source on GitHub">Fork me on GitHub</a><script>(()=>{"use strict";class t{constructor(){var t,e;e={},(t="_data")in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e}_setVal(t,e,i){const n=this._data,s=function(t){return 0===t?"0":t?t.toString():""}(i);var o;s?(n[t]||(n[t]={}),n[t][e]=s):n[t]&&n[t][e]&&(delete n[t][e],o=n[t],0===Object.keys(o).length&&delete n[t])}_clear(){this._data={}}_getVal(t,e){const i=this._data;return i&&i[t]&&i[t][e]||""}_toArr(t,e){const i=[];for(let n=0;n<e;n++){i.push([]);for(let e=0;e<t;e++)i[n].push(this._getVal(e,n))}return i}}function e(t,e,i,n,s,o,l){if((t+=i)<n){if(s===1/0)return{x:n,y:e};if(t=s,--e<o){if(l===1/0)return{x:n,y:o};e=l}}return t>s&&(t=n,++e>l&&(e=o,t=n)),{x:t,y:e}}function i(t){return t.split('"').length-1}function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const s=["mousedown","mouseenter","mouseup","mouseleave","touchstart","touchend","touchmove","keydown","paste","cut","copy"];class o{constructor(e){n(this,"_width",1),n(this,"_height",1),n(this,"_data",new t),n(this,"paste",(t=>{if(this._editing)return;t.preventDefault();const e=function(t){var e,n,s,o,l,r,h,a=[],d=0;for((s=t.split("\n")).length>1&&""===s[s.length-1]&&s.pop(),e=0,n=s.length;e<n;e+=1){for(s[e]=s[e].split("\t"),o=0,l=s[e].length;o<l;o+=1)a[d]||(a[d]=[]),r&&0===o?(h=a[d].length-1,a[d][h]=a[d][h]+"\n"+s[e][0],r&&1&i(s[e][0])&&(r=!1,a[d][h]=a[d][h].substring(0,a[d][h].length-1).replace(/""/g,'"'))):o===l-1&&0===s[e][o].indexOf('"')&&1&i(s[e][o])?(a[d].push(s[e][o].substring(1).replace(/""/g,'"')),r=!0):(a[d].push(s[e][o].replace(/""/g,'"')),r=!1);r||(d+=1)}return a}((t.clipboardData||window.clipboardData).getData("text/plain")),{rx:n,ry:s}=this._selection,o={x:n[0],y:s[0]};for(let t=0;t<e.length;t++)for(let i=0;i<e[0].length;i++)this._setVal(o.x+i,o.y+t,e[t][i]);this._changeSelectedCellsStyle((()=>{this._selectionStart=o,this._selectionEnd={x:o.x+e[0].length-1,y:o.y+e.length-1},this._onDataChanged()}))})),n(this,"copy",(t=>{if(this._editing)return;const e=this._getSelectionAsArray();e&&(t.preventDefault(),t.clipboardData.setData("text/plain",function(t){var e,i,n,s,o,l="";for(e=0,i=t.length;e<i;e+=1){for(n=0,s=t[e].length;n<s;n+=1)n>0&&(l+="\t"),"string"==typeof(o=t[e][n])?o.indexOf("\n")>-1?l+='"'+o.replace(/"/g,'""')+'"':l+=o:l+=null==o?"":o;l+="\n"}return l}(e)))})),n(this,"cut",(t=>{this._editing||(this.copy(t),this._setAllSelectedCellsTo(""))})),n(this,"keydown",(t=>{t.ctrlKey?this._editing&&(t.preventDefault(),this._revertEdit(),this._stopEditing()):("KeyA"!=t.code||this._editing||(t.preventDefault(),this._startEditing(this._focus),this.keydown(t)),this._selectionStart&&("Escape"===t.key&&this._editing&&(t.preventDefault(),this._revertEdit(),this._stopEditing()),"Enter"===t.key&&(t.preventDefault(),this._tabCursorInSelection(!1,t.shiftKey?-1:1),this._startEditing(this._focus)),"Tab"===t.key&&(t.preventDefault(),this._tabCursorInSelection(!0,t.shiftKey?-1:1)),this._editing||("F2"===t.key&&(t.preventDefault(),this._startEditing(this._focus)),"Delete"!==t.key&&"Backspace"!==t.key||(t.preventDefault(),this._setAllSelectedCellsTo(""))),"ArrowDown"===t.key&&(t.preventDefault(),this._moveCursor({y:1},t.shiftKey),this._startEditing(this._focus)),"ArrowUp"===t.key&&(t.preventDefault(),this._moveCursor({y:-1},t.shiftKey),this._startEditing(this._focus)),"ArrowLeft"===t.key&&(t.preventDefault(),this._moveCursor({x:-1},t.shiftKey),this._startEditing(this._focus)),"ArrowRight"===t.key&&(t.preventDefault(),this._moveCursor({x:1},t.shiftKey),this._startEditing(this._focus))))})),n(this,"_selecting",!1),n(this,"_selectionStart",null),n(this,"_selectionEnd",null),n(this,"_selection",{rx:[0,0],ry:[0,0]}),n(this,"_editing",null),n(this,"_focus",null),n(this,"_option_pos",{}),n(this,"mousedown",(t=>{if(!this.mobile){if(3===t.which&&!this._editing&&this._selectionSize()){let t=new Range;const{rx:e,ry:i}=this._selection;return t.setStart(this._getCell(e[0],i[0]),0),t.setEnd(this._getCell(e[0],i[0]),1),this.cwd.getSelection().removeAllRanges(),void this.cwd.getSelection().addRange(t)}!this._editing||this._getCoords(t).x===this._editing.x&&this._getCoords(t).y===this._editing.y||this._stopEditing(),this._changeSelectedCellsStyle((()=>{this.tbody.style.userSelect="none",this._selectionEnd=this._selectionStart=this._focus=this._getCoords(t),this._selecting=!0,this._startEditing(this._focus)}))}})),n(this,"mouseenter",(t=>{this.mobile})),n(this,"_lastMouseUp",null),n(this,"_lastMouseUpTarget",null),n(this,"mouseup",(t=>{this.mobile||3!==t.which&&this._selecting&&this._changeSelectedCellsStyle((()=>{this._selectionEnd=this._getCoords(t),this._endSelection(),this._startEditing(this._focus),this._lastMouseUp&&this._lastMouseUp>Date.now()-300&&this._lastMouseUpTarget.x===this._selectionEnd.x&&this._lastMouseUpTarget.y===this._selectionEnd.y&&this._startEditing(this._selectionEnd),this._lastMouseUp=Date.now(),this._lastMouseUpTarget=this._selectionEnd}))})),n(this,"mouseleave",(t=>{t.target===this.tbody&&this._selecting&&this._endSelection()})),n(this,"touchstart",(t=>{this._editing||(this.mobile=!0,this.moved=!1)})),n(this,"touchend",(t=>{this.mobile&&(this._editing||this.moved||(this._changeSelectedCellsStyle((()=>{this._selectionEnd=this._selectionStart=this._focus=this._getCoords(t)})),this._startEditing(this._focus)))})),n(this,"touchmove",(t=>{this.mobile&&(this.moved=!0)})),n(this,"_stopEditing",(()=>{if(!this._editing)return;this._option_pos&&(this._option_pos={});const{x:t,y:e}=this._editing,i=this._getCell(t,e);i.style.width="",i.style.height="";const n=i.firstChild;n.removeEventListener("blur",this._stopEditing),n.removeEventListener("keydown",this._blurIfEnter),this._setVal(t,e,n.value),this._onDataChanged(),i.removeChild(n),this._editing=null,this._renderTDContent(i,t,e)})),n(this,"_blurIfEnter",(t=>{13===t.keyCode&&(this._stopEditing(),t.preventDefault())})),n(this,"_selectChange",(t=>{console.log(t),this._stopEditing()})),n(this,"_restyle",(({x:t,y:e})=>{const i=this._getCell(t,e);i.className=this._classNames(t,e);const n=l(this.checkResults.titles,t,e);n?i.setAttribute("title",n):i.removeAttribute("title")})),n(this,"_refreshDisplayedValue",(({x:t,y:e})=>{const i=this._getCell(t,e).firstChild;"DIV"===i.tagName&&(i.textContent=this._divContent(t,e)),this._restyle({x:t,y:e})})),this._saveConstructorOptions(e),this._setupDom(),this._replaceDataWithArray(e.data),this._incrementToFit({x:this.columns.length-1,y:this._options.minRows-1}),this._fillScrollSpace()}_runChecks(t){const{titles:e,classNames:i}=this.checks(t);this.checkResults={titles:e,classNames:i}}_saveConstructorOptions({data:t=[],node:e=null,onChange:i=null,minRows:n=1,maxRows:s=1/0,css:o="",width:l="100%",height:r="80vh",columns:h,checks:a,select:d=[],bond:c=[]}){if(this.columns=h,this.checks=a||(()=>({})),this._runChecks(t),!e)throw new Error("You need to pass a node argument to Importabular, like this : new Importabular({node: document.body})");this._parent=e,this._options={onChange:i,minRows:n,maxRows:s,css:"\nhtml{\n  overflow: auto;\n}\n*{\n  box-sizing: border-box;\n}\niframe{\n  position:absolute;\n}\nbody{\n  padding: 0; \n  margin: 0;\n}\ntable{\n  border-spacing: 0;\n  background: white;\n  border: 1px solid #ddd;\n  border-width: 0 1px 1px 0;\n  font-size: 16px;\n  font-family: sans-serif;\n  border-collapse: separate;\n  min-width:100%;\n}\ntd, th{\n  padding:0;\n  border: 1px solid;\n  border-color: #ddd transparent transparent #ddd; \n}\ntd.selected.multi:not(.editing){\n  background:#d7f2f9;\n} \ntd.focus:not(.editing){\n  border-color: #13ac59;\n} \ntd>*, th>*{\n  border:none;\n  padding:10px;\n  min-width:10px;\n  min-height: 40px;\n  font:inherit;\n  line-height: 20px;\n  color:inherit;\n  white-space: normal;\n}\ntd>div::selection {\n    color: none;\n    background: none;\n}\n\n.placeholder div{\n  user-select:none;\n  color:rgba(0,0,0,0.2);\n}\n*[title] div{cursor:help;}\nth{text-align:left;}\n"+o,select:d,bond:c},this._iframeStyle={width:l,height:r,border:"none",position:"absolute",background:"transparent",borderRadius:"5px"}}_fitBounds({x:t,y:e}){return t>=0&&t<this.columns.length&&e>=0&&e<this._options.maxRows}_fillScrollSpace(){const t=Math.ceil(this.iframe.contentWindow.innerHeight/40),e=Math.ceil(this.iframe.contentWindow.innerWidth/100);this._incrementToFit({x:e-1,y:t-1})}getData(){return this._data._toArr(this._width,this._height)}_onDataChanged(){const t=this.getData();this._options.onChange&&this._options.onChange(t),this._runChecks(t),this._restyleAll()}_renderTDContent(t,e,i){var n=document.createElement("div");t.setAttribute("x",e.toString()),t.setAttribute("y",i.toString()),t.setAttribute("id",e.toString()+i.toString());const s=this._divContent(e,i);s?n.textContent=s:n.innerHTML="&nbsp;",t.appendChild(n),this._restyle({x:e,y:i})}_divContent(t,e){return this._getVal(t,e)||this.columns[t].placeholder}_selsectContent(t,e){return this._getVal(t,e)||this.columns[t].placeholder}_setupDom(){const t=document.createElement("iframe");this.iframe=t,this._parent.appendChild(t);const e=t.contentWindow.document;this.cwd=e,e.open(),e.write(`<html lang="${navigator.language}"><body><style>${this._options.css}</style></body></html>`),e.close(),Object.assign(t.style,this._iframeStyle);const i=document.createElement("table"),n=document.createElement("tbody"),o=document.createElement("THEAD"),l=document.createElement("TR"),r=document.createElement("TR"),h=[];this._options.bond.length>0?(o.appendChild(r),o.appendChild(l),this.columns.forEach(((t,e)=>{const i=document.createElement("TH"),n=document.createElement("div");let s=!1;for(const o of this._options.bond)if(e>=o.startRow&&e<o.startRow+o.rowSize){e===o.startRow&&(n.innerHTML=o.label,o.label&&i.appendChild(n),i.setAttribute("colspan",o.rowSize),r.appendChild(i)),h.push(t),s=!0;break}s||(n.innerHTML=t.label,t.title&&i.setAttribute("title",t.title),i.appendChild(n),r.appendChild(i),i.setAttribute("rowspan","2"))})),h.forEach((t=>{const e=document.createElement("TH"),i=document.createElement("div");i.innerHTML=t.label,t.title&&e.setAttribute("title",t.title),e.appendChild(i),l.appendChild(e)})),i.appendChild(o),i.appendChild(n),e.body.appendChild(i),this.tbody=n,this.table=i):(o.appendChild(r),this.columns.forEach((t=>{const e=document.createElement("TH"),i=document.createElement("div");i.innerHTML=t.label,t.title&&e.setAttribute("title",t.title),e.appendChild(i),r.appendChild(e)}))),i.appendChild(o),i.appendChild(n),e.body.appendChild(i),this.tbody=n,this.table=i;for(let t=0;t<this._height;t++){const e=document.createElement("tr");n.appendChild(e);for(let i=0;i<this._width;i++)this._addCell(e,i,t)}s.forEach((t=>e.addEventListener(t,this[t],!0)))}destroy(){this._destroyEditing(),s.forEach((t=>this.cwd.removeEventListener(t,this[t],!0))),this.iframe.parentElement.removeChild(this.iframe)}_addCell(t,e,i){const n=document.createElement("td");t.appendChild(n),this._renderTDContent(n,e,i)}_incrementHeight(){if(!this._fitBounds({x:0,y:this._height}))return!1;this._height++;const t=this._height-1,e=document.createElement("tr");this.tbody.appendChild(e);for(let i=0;i<this._width;i++)this._addCell(e,i,t);return!0}_incrementWidth(){if(!this._fitBounds({x:this._width,y:0}))return!1;this._width++;const t=this._width-1;return Array.prototype.forEach.call(this.tbody.children,((e,i)=>{this._addCell(e,t,i)})),!0}_incrementToFit({x:t,y:e}){for(;t>this._width-1&&this._incrementWidth(););for(;e>this._height-1&&this._incrementHeight(););}_getSelectionAsArray(){const{rx:t,ry:e}=this._selection;if(t[0]===t[1])return null;const i=t[1]-t[0],n=e[1]-e[0],s=[];for(let o=0;o<n;o++){s.push([]);for(let n=0;n<i;n++)s[o].push(this._getVal(t[0]+n,e[0]+o))}return s}_setAllSelectedCellsTo(t){this._forSelectionCoord(this._selection,(({x:e,y:i})=>this._setVal(e,i,t))),this._onDataChanged(),this._forSelectionCoord(this._selection,this._refreshDisplayedValue)}_moveCursor({x:t=0,y:e=0},i){const n=i?this._selectionEnd:this._selectionStart,s={x:n.x+t,y:n.y+e};this._fitBounds(s)&&(this._stopEditing(),this._incrementToFit(s),this._changeSelectedCellsStyle((()=>{i?this._selectionEnd=s:this._selectionStart=this._selectionEnd=this._focus=s})),this._scrollIntoView(s))}_tabCursorInSelection(t,i=1){let{x:n,y:s}=this._focus||{x:0,y:0};const o=this._selectionSize(),{rx:l,ry:r}=o>1?this._selection:{rx:[0,this.columns.length],ry:[0,this._options.maxRows]};let h;if(t)h=e(n,s,i,l[0],l[1]-1,r[0],r[1]-1);else{const t=e(s,n,i,r[0],r[1]-1,l[0],l[1]-1);h={x:t.y,y:t.x}}this._fitBounds(h)&&(this._stopEditing(),this._incrementToFit(h),this._changeSelectedCellsStyle((()=>{this._focus=h,o<=1&&(this._selectionStart=this._selectionEnd=h)})),this._scrollIntoView(h))}_scrollIntoView({x:t,y:e}){this._getCell(t,e).scrollIntoView({behavior:"smooth",block:"nearest"})}_endSelection(){this._selecting=!1,this.tbody.style.userSelect=""}_startEditing({x:t,y:e}){this._editing={x:t,y:e};const i=this._getCell(t,e),n=i.getBoundingClientRect(),s=i.firstChild.getBoundingClientRect();if("SELECT"==i.firstChild.nodeName)return;if(this._option_pos={},"SELECT"!==i.firstChild.nodeName)try{i.removeChild(i.firstChild)}catch(t){return console.log(i.firstChild.nodeName),void console.log(t)}else console.log(i.firstChild.nodeName);const o=document.createElement("input"),l=document.createElement("select");let r=!0;this._options.select.length>0?(this._options.select.forEach(((s,o)=>{if(t===s.rowIndex){l.value=this._getVal(t,e),i.appendChild(l),Object.assign(i.style,{width:n.width-2,height:n.height}),Object.assign(l.style,{width:n.width-2,height:n.height-2,outline:"none",background:"transparent"}),l.focus(),l.addEventListener("blur",this._stopEditing),l.addEventListener("keydown",this._blurIfEnter),l.addEventListener("change",this._selectChange);const s=document.createElement("option");s.text="",s.value="",l.appendChild(s),this._options.select[o].selectableInfo.forEach((i=>{const n=document.createElement("option");i.text==this._getVal(t,e)&&(n.selected=!0),n.text=i.text,n.value=i.text,l.appendChild(n)})),r=!1,this._option_pos.x=t,this._option_pos.y=e}})),r&&(o.type="text",o.value=this._getVal(t,e),i.appendChild(o),Object.assign(i.style,{width:n.width-2,height:n.height}),Object.assign(o.style,{width:`${s.width}px`,height:n.height-2,outline:"none",background:"transparent"}),o.focus(),o.addEventListener("blur",this._stopEditing),o.addEventListener("keydown",this._blurIfEnter))):(o.type="text",o.value=this._getVal(t,e),i.appendChild(o),Object.assign(i.style,{width:n.width-2,height:n.height}),Object.assign(o.style,{width:`${s.width}px`,height:n.height-2,outline:"none",background:"transparent"}),o.focus(),o.addEventListener("blur",this._stopEditing),o.addEventListener("keydown",this._blurIfEnter))}_destroyEditing(){if(this._editing){const{x:t,y:e}=this._editing,i=this._getCell(t,e).firstChild;i.removeEventListener("blur",this._stopEditing),i.removeEventListener("keydown",this._blurIfEnter)}}_revertEdit(){if(!this._editing)return;const{x:t,y:e}=this._editing;this._getCell(t,e).firstChild.value=this._getVal(t,e)}_changeSelectedCellsStyle(t){const e=this._selection;t(),this._selection=this._getSelectionCoords(),this._forSelectionCoord(e,this._restyle),this._forSelectionCoord(this._selection,this._restyle)}_getSelectionCoords(){if(!this._selectionStart)return{rx:[0,0],ry:[0,0]};let t=[this._selectionStart.x,this._selectionEnd.x];t[0]>t[1]&&t.reverse();let e=[this._selectionStart.y,this._selectionEnd.y];return e[0]>e[1]&&e.reverse(),{rx:[t[0],t[1]+1],ry:[e[0],e[1]+1]}}_forSelectionCoord({rx:t,ry:e},i){for(let n=t[0];n<t[1];n++)for(let t=e[0];t<e[1];t++)this._fitBounds({x:n,y:t})&&i({x:n,y:t})}_restyleAll(){for(var t=0;t<this._width;t++)for(var e=0;e<this._height;e++)this._restyle({x:t,y:e})}_selectionSize(){const{rx:t,ry:e}=this._selection;return(t[1]-t[0])*(e[1]-e[0])}_classNames(t,e){const{rx:i,ry:n}=this._selection;let s="";return t>=i[0]&&t<i[1]&&e>=n[0]&&e<n[1]&&(s+=" selected",this._selectionSize()>1&&(s+=" multi")),this._focus&&this._focus.x===t&&this._focus.y===e&&(s+=" focus"),this._editing&&t===this._editing.x&&e===this._editing.y&&(s+=" editing"),this._getVal(t,e)||(s+=" placeholder"),s+=" "+l(this.checkResults.classNames,t,e),s}_getCoords(t){let e=t.target;for(;e.getAttribute&&!e.getAttribute("x")&&e.parentElement;)e=e.parentElement;return{x:parseInt(e.getAttribute("x"))||0,y:parseInt(e.getAttribute("y"))||0}}setData(t){this._data._clear(),this._replaceDataWithArray(t);for(let t=0;t<this._width;t++)for(let e=0;e<this._height;e++)this._refreshDisplayedValue({x:t,y:e})}_replaceDataWithArray(t=[[]]){t.forEach(((t,e)=>{t.forEach(((t,i)=>{this._setVal(i,e,t)}))}))}_setVal(t,e,i){this._fitBounds({x:t,y:e})&&(this._data._setVal(t,e,i),this._incrementToFit({x:t+1,y:e+1}),this._refreshDisplayedValue({x:t,y:e}))}_getVal(t,e){return this._data._getVal(t,e)}_getCell(t,e){return this.tbody.children[e].children[t]}}function l(t,e,i){return t&&t[i]&&t[i][e]||""}function r([t,e,i]){if(!t&&(e||i))return"Name is required"}function h([t,e,i]){if(e&&!e.match(/\+[0-9]+/))return"Invalid phone number"}function a([t,e,i]){return t&&!i?"Email is required":i.match(/[a-z0-9.-]+@[a-z0-9.-]+/gi)?void 0:"Invalid  email address"}function d(t,e){const i=document.createElement("pre"),n=t.replace(/ from "[^;]*;/,' from "importabular";');i.innerText=n,document.querySelector('code[data-script="'+e+'"]').appendChild(i)}new o({node:document.getElementById("editor"),columns:[{label:"Contact name"},{label:"Phone number"},{label:"Email address"}]}),new o({node:document.getElementById("with-checks"),columns:[{label:"Contact name",title:"Full name",placeholder:"John Doe"},{label:"Phone number",title:"In the international format",placeholder:"+33XXXXXXX"},{label:"Email address",placeholder:"xxxx@yyyy.zzz"}],data:[["Name","+333555555","email@adress"],["Bad data","33366666","email@"],["","","missing@name"]],select:[{rowIndex:1,selectableInfo:[{value:1,text:"x"},{value:2,text:"y"}]}],checks:function(t){const e=t.map((t=>[r(t),h(t),a(t)])),i=t.map(((t,i)=>[e[i][0]?"invalid":t[0]&&"valid",e[i][1]?"invalid":t[1]&&"valid",e[i][2]?"invalid":t[2]&&"valid"]));return{titles:e,classNames:i}},css:"\n  td>div{\n    border-right:2px solid transparent;\n  }\n  td.invalid >div{\n    border-right:2px solid red;\n    background:rgba(255,0,0,0.1);\n  }\n  td.valid > div{\n    border-right:2px solid green;\n  \n  }\n  \n  ",onChange(t){console.table(t)}}),d('import Importabular from "../../index";\n\nconst sheet = new Importabular({\n  node: document.getElementById("editor"),\n  columns: [\n    {\n      label: "Contact name",\n    },\n    {\n      label: "Phone number",\n    },\n    {\n      label: "Email address",\n    },\n  ],\n});\n',"simple"),d('import Importabular from "../../index";\n\nconst sheet = new Importabular({\n  node: document.getElementById("with-checks"),\n  columns: [\n    {\n      label: "Contact name",\n      title: "Full name",\n      placeholder: "John Doe",\n    },\n    {\n      label: "Phone number",\n      title: "In the international format",\n      placeholder: "+33XXXXXXX",\n    },\n    {\n      label: "Email address",\n      placeholder: "xxxx@yyyy.zzz",\n    },\n  ],\n  data: [\n    ["Name", "+333555555", "email@adress"],\n    ["Bad data", "33366666", "email@"],\n    ["", "", "missing@name"],\n  ],\n  select: [{"rowIndex":1,"selectableInfo":[{"value":1,"text":"x"},{"value":2,"text":"y"}]}],\n  checks: checkData,\n  css: `\n  td>div{\n    border-right:2px solid transparent;\n  }\n  td.invalid >div{\n    border-right:2px solid red;\n    background:rgba(255,0,0,0.1);\n  }\n  td.valid > div{\n    border-right:2px solid green;\n  \n  }\n  \n  `,\n  onChange(data) {\n    console.table(data);\n  },\n});\n\nfunction checkData(data) {\n  // Generate tooltip content for each problem\n  const titles = data.map((line) => [\n    checkName(line),\n    checkPhone(line),\n    checkEmail(line),\n  ]);\n\n  // Display the cell as invalid if there\'s a problem\n  const classNames = data.map((line, index) => [\n    titles[index][0] ?  "invalid": line[0] && "valid",\n    titles[index][1] ?  "invalid": line[1] && "valid",\n    titles[index][2] ?  "invalid": line[2] && "valid",\n  ]);\n\n  return { titles, classNames };\n}\n\nfunction checkName([name, phone, email]) {\n\n  if(!name && (phone || email)){\n    return \'Name is required\'\n  }\n}\nfunction checkPhone([name, phone, email]) {\n  if(phone && !phone.match(/\\+[0-9]+/))\n    return  \'Invalid phone number\'\n}\n\nfunction checkEmail([name, phone, email]) {\n  if(name && !email)\n    return  \'Email is required\'\n\n  if(!email.match(/[a-z0-9.-]+@[a-z0-9.-]+/gi)){\n    return \'Invalid  email address\'\n  }\n}\n',"with-checks")})();</script></body></html>